<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Observability</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Observability</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_administrator-metrics">Administrator metrics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="serverless-admin-metrics">Serverless administrator metrics</h3>
<div class="paragraph">
<p>Metrics enable cluster administrators to monitor how OpenShift Serverless cluster components and workloads are performing.</p>
</div>
<div class="paragraph">
<p>You can view different metrics for OpenShift Serverless by navigating to <a href="https://docs.openshift.com/container-platform/latest/monitoring/reviewing-monitoring-dashboards.html#reviewing-monitoring-dashboards-admin_reviewing-monitoring-dashboards"><strong>Dashboards</strong></a> in the web console <strong>Administrator</strong> perspective.</p>
</div>
<div class="sect3">
<h4 id="prerequisites_serverless-admin-metrics">Prerequisites</h4>
<div class="ulist">
<ul>
<li>
<p>See the OpenShift Container Platform documentation on <a href="https://docs.openshift.com/container-platform/latest/monitoring/managing-metrics.html#managing-metrics">Managing metrics</a> for information about enabling metrics for your cluster.</p>
</li>
<li>
<p>You have access to an account with cluster administrator access (or dedicated administrator access for OpenShift Dedicated or Red Hat OpenShift Service on AWS).</p>
</li>
<li>
<p>You have access to the <strong>Administrator</strong> perspective in the web console.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>If Service Mesh is enabled with mTLS, metrics for Knative Serving are disabled by default because Service Mesh prevents Prometheus from scraping metrics.</p>
</div>
<div class="paragraph">
<p>For information about resolving this issue, see <a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_serverless/1.29/html-single/integrations/#serverless-ossm-enabling-serving-metrics_serverless-ossm-setup">Enabling Knative Serving metrics when using Service Mesh with mTLS</a>.</p>
</div>
<div class="paragraph">
<p>Scraping the metrics does not affect autoscaling of a Knative service, because scraping requests do not go through the activator. Consequently, no scraping takes place if no pods are running.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="serverless-controller-metrics">Serverless controller metrics</h3>
<div class="paragraph">
<p>The following metrics are emitted by any component that implements a controller logic. These metrics show details about reconciliation operations and the work queue behavior upon which reconciliation requests are added to the work queue.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>work_queue_depth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The depth of the work queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconciler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconcile_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of reconcile operations.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconciler</code>, <code>success</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconcile_latency</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latency of reconcile operations.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconciler</code>, <code>success</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workqueue_adds_total</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The total number of add actions handled by the work queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workqueue_queue_latency_seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The length of time an item stays in the work queue before being requested.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workqueue_retries_total</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The total number of retries that have been handled by the work queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workqueue_work_duration_seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The length of time it takes to process and item from the work queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workqueue_unfinished_work_seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The length of time that outstanding work queue items have been in progress.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workqueue_longest_running_processor_seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The length of time that the longest outstanding work queue items has been in progress.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="serverless-webhook-metrics">Webhook metrics</h3>
<div class="paragraph">
<p>Webhook metrics report useful information about operations. For example, if a large number of operations fail, this might indicate an issue with a user-created resource.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>request_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of requests that are routed to the webhook.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admission_allowed</code>, <code>kind_group</code>, <code>kind_kind</code>, <code>kind_version</code>, <code>request_operation</code>, <code>resource_group</code>, <code>resource_namespace</code>, <code>resource_resource</code>, <code>resource_version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>request_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response time for a webhook request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admission_allowed</code>, <code>kind_group</code>, <code>kind_kind</code>, <code>kind_version</code>, <code>request_operation</code>, <code>resource_group</code>, <code>resource_namespace</code>, <code>resource_resource</code>, <code>resource_version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="serverless-admin-metrics-eventing">Knative Eventing metrics</h3>
<div class="paragraph">
<p>Cluster administrators can view the following metrics for Knative Eventing components.</p>
</div>
<div class="paragraph">
<p>By aggregating the metrics from HTTP code, events can be separated into two categories; successful events (2xx) and failed events (5xx).</p>
</div>
<div class="sect3">
<h4 id="serverless-broker-ingress-metrics_serverless-admin-metrics-eventing">Broker ingress metrics</h4>
<div class="paragraph">
<p>You can use the following metrics to debug the broker ingress, see how it is performing, and see which events are being dispatched by the ingress component.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of events received by a broker.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>event_type</code>, <code>namespace_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_dispatch_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time taken to dispatch an event to a channel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>event_type</code>, <code>namespace_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="serverless-broker-filter-metrics_serverless-admin-metrics-eventing">Broker filter metrics</h4>
<div class="paragraph">
<p>You can use the following metrics to debug broker filters, see how they are performing, and see which events are being dispatched by the filters. You can also measure the latency of the filtering action on an event.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of events received by a broker.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>container_name</code>, <code>filter_type</code>, <code>namespace_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>trigger_name</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_dispatch_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time taken to dispatch an event to a channel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>container_name</code>, <code>filter_type</code>, <code>namespace_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>trigger_name</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_processing_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time it takes to process an event before it is dispatched to a trigger subscriber.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>container_name</code>, <code>filter_type</code>, <code>namespace_name</code>, <code>trigger_name</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="serverless-inmemory-dispatch-metrics_serverless-admin-metrics-eventing">InMemoryChannel dispatcher metrics</h4>
<div class="paragraph">
<p>You can use the following metrics to debug <code>InMemoryChannel</code> channels, see how they are performing, and see which events are being dispatched by the channels.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of events dispatched by <code>InMemoryChannel</code> channels.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>container_name</code>, <code>filter_type</code>, <code>namespace_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>trigger_name</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_dispatch_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time taken to dispatch an event from an <code>InMemoryChannel</code> channel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>container_name</code>, <code>filter_type</code>, <code>namespace_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>trigger_name</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="serverless-event-source-metrics_serverless-admin-metrics-eventing">Event source metrics</h4>
<div class="paragraph">
<p>You can use the following metrics to verify that events have been delivered from the event source to the connected event sink.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of events sent by the event source.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>broker_name</code>, <code>container_name</code>, <code>filter_type</code>, <code>namespace_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>trigger_name</code>, <code>unique_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>retry_event_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of retried events sent by the event source after initially failing to be delivered.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event_source</code>, <code>event_type</code>, <code>name</code>, <code>namespace_name</code>, <code>resource_group</code>, <code>response_code</code>, <code>response_code_class</code>, <code>response_error</code>, <code>response_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="serverless-admin-metrics-serving">Knative Serving metrics</h3>
<div class="paragraph">
<p>Cluster administrators can view the following metrics for Knative Serving components.</p>
</div>
<div class="sect3">
<h4 id="serverless-activator-metrics_serverless-admin-metrics-serving">Activator metrics</h4>
<div class="paragraph">
<p>You can use the following metrics to understand how applications respond when traffic passes through the activator.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>request_concurrency</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of concurrent requests that are routed to the activator, or average concurrency over a reporting period.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>container_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>request_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of requests that are routed to activator. These are requests that have been fulfilled from the activator handler.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>container_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>revision_name</code>, <code>service_name</code>,</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>request_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response time in milliseconds for a fulfilled, routed request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>container_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="serverless-autoscaler-metrics_serverless-admin-metrics-serving">Autoscaler metrics</h4>
<div class="paragraph">
<p>The autoscaler component exposes a number of metrics related to autoscaler behavior for each revision. For example, at any given time, you can monitor the targeted number of pods the autoscaler tries to allocate for a service, the average number of requests per second during the stable window, or whether the autoscaler is in panic mode if you are using the Knative pod autoscaler (KPA).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>desired_pods</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pods the autoscaler tries to allocate for a service.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>excess_burst_capacity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The excess burst capacity served over the stable window.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stable_request_concurrency</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average number of requests for each observed pod over the stable window.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>panic_request_concurrency</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average number of requests for each observed pod over the panic window.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>target_concurrency_per_pod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of concurrent requests that the autoscaler tries to send to each pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stable_requests_per_second</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average number of requests-per-second for each observed pod over the stable window.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>panic_requests_per_second</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average number of requests-per-second for each observed pod over the panic window.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>target_requests_per_second</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of requests-per-second that the autoscaler targets for each pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>panic_mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This value is <code>1</code> if the autoscaler is in panic mode, or <code>0</code> if the autoscaler is not in panic mode.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requested_pods</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pods that the autoscaler has requested from the Kubernetes cluster.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>actual_pods</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pods that are allocated and currently have a ready state.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>not_ready_pods</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pods that have a not ready state.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pending_pods</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pods that are currently pending.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>terminating_pods</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pods that are currently terminating.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="serverless-go-metrics_serverless-admin-metrics-serving">Go runtime metrics</h4>
<div class="paragraph">
<p>Each Knative Serving control plane process emits a number of Go runtime memory statistics (<a href="https://golang.org/pkg/runtime/#MemStats">MemStats</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>name</code> tag for each metric is an empty tag.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_alloc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of allocated heap objects. This metric is the same as <code>heap_alloc</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_total_alloc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cumulative bytes allocated for heap objects.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The total bytes of memory obtained from the operating system.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_lookups</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pointer lookups performed by the runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_mallocs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cumulative count of heap objects allocated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_frees</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cumulative count of heap objects that have been freed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_heap_alloc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of allocated heap objects.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_heap_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of heap memory obtained from the operating system.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_heap_idle</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes in idle, unused spans.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_heap_in_use</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes in spans that are currently in use.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_heap_released</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of physical memory returned to the operating system.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_heap_objects</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of allocated heap objects.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_stack_in_use</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes in stack spans that are currently in use.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_stack_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of stack memory obtained from the operating system.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_mspan_in_use</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of allocated <code>mspan</code> structures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_mspan_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of memory obtained from the operating system for <code>mspan</code> structures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_mcache_in_use</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of allocated <code>mcache</code> structures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_mcache_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of memory obtained from the operating system for <code>mcache</code> structures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_bucket_hash_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of memory in profiling bucket hash tables.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_gc_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of memory in garbage collection metadata.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_other_sys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of bytes of memory in miscellaneous, off-heap runtime allocations.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_next_gc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The target heap size of the next garbage collection cycle.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_last_gc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time that the last garbage collection was completed in <a href="https://en.wikipedia.org/wiki/Unix_time"><em>Epoch</em> or Unix time</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nanoseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_total_gc_pause_ns</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cumulative time in garbage collection <em>stop-the-world</em> pauses since the program started.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nanoseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_num_gc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of completed garbage collection cycles.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_num_forced_gc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of garbage collection cycles that were forced due to an application calling the garbage collection function.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>go_gc_cpu_fraction</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fraction of the available CPU time of the program that has been used by the garbage collector since the program started.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_developer-metrics">Developer metrics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="serverless-developer-metrics">Serverless developer metrics overview</h3>
<div class="paragraph">
<p>Metrics enable developers to monitor how Knative services are performing. You can use the OpenShift Container Platform monitoring stack to record and view health checks and metrics for your Knative services.</p>
</div>
<div class="paragraph">
<p>You can view different metrics for OpenShift Serverless by navigating to <a href="https://docs.openshift.com/container-platform/latest/monitoring/reviewing-monitoring-dashboards.html#reviewing-monitoring-dashboards-developer_reviewing-monitoring-dashboards"><strong>Dashboards</strong></a> in the  web console <strong>Developer</strong> perspective.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>If Service Mesh is enabled with mTLS, metrics for Knative Serving are disabled by default because Service Mesh prevents Prometheus from scraping metrics.</p>
</div>
<div class="paragraph">
<p>For information about resolving this issue, see <a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_serverless/1.29/html-single/integrations/#serverless-ossm-enabling-serving-metrics_serverless-ossm-setup">Enabling Knative Serving metrics when using Service Mesh with mTLS</a>.</p>
</div>
<div class="paragraph">
<p>Scraping the metrics does not affect autoscaling of a Knative service, because scraping requests do not go through the activator. Consequently, no scraping takes place if no pods are running.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 _additional-resources">
<h4 id="additional-resources_serverless-service-monitoring">Additional resources for OpenShift Container Platform</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.openshift.com/container-platform/latest/monitoring/monitoring-overview.html#monitoring-overview">Monitoring overview</a></p>
</li>
<li>
<p><a href="https://docs.openshift.com/container-platform/latest/monitoring/managing-metrics.html#specifying-how-a-service-is-monitored">Enabling monitoring for user-defined projects</a></p>
</li>
<li>
<p><a href="https://docs.openshift.com/container-platform/latest/monitoring/enabling-monitoring-for-user-defined-projects.html#enabling-monitoring-for-user-defined-projects">Specifying how a service is monitored</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="serverless-monitoring-services-default-metrics">Knative service metrics exposed by default</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Metrics exposed by default for each Knative service on port 9090</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name, unit, and type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Metric tags</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>queue_requests_per_second</code></p>
<p class="tableblock">Metric unit: dimensionless</p>
<p class="tableblock">Metric type: gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of requests per second that hit the queue proxy.</p>
<p class="tableblock">Formula: <code>stats.RequestCount / r.reportingPeriodSeconds</code></p>
<p class="tableblock"><code>stats.RequestCount</code> is calculated directly from the networking <code>pkg</code> stats for the given reporting duration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination_configuration="event-display",
destination_namespace="pingsource1",
destination_pod="event-display-00001-deployment-6b455479cb-75p6w",
destination_revision="event-display-00001"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>queue_proxied_operations_per_second</code></p>
<p class="tableblock">Metric unit: dimensionless</p>
<p class="tableblock">Metric type: gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of proxied requests per second.</p>
<p class="tableblock">Formula: <code>stats.ProxiedRequestCount / r.reportingPeriodSeconds</code></p>
<p class="tableblock"><code>stats.ProxiedRequestCount</code> is calculated directly from the networking <code>pkg</code> stats for the given reporting duration.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>queue_average_concurrent_requests</code></p>
<p class="tableblock">Metric unit: dimensionless</p>
<p class="tableblock">Metric type: gauge</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Number of requests currently being handled by this pod.</p>
</div>
<div class="paragraph">
<p>Average concurrency is calculated at the networking <code>pkg</code> side as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a <code>req</code> change happens, the time delta between changes is calculated. Based on the result, the current concurrency number over delta is computed and added to the current computed concurrency. Additionally, a sum of the deltas is kept.</p>
<div class="paragraph">
<p>Current concurrency over delta is computed as follows:</p>
</div>
<div class="paragraph">
<p><code>global_concurrency</code>  delta</p>
</div>
</li>
<li>
<p>Each time a reporting is done, the sum and current computed concurrency are reset.</p>
</li>
<li>
<p>When reporting the average concurrency the current computed concurrency is divided by the sum of deltas.</p>
</li>
<li>
<p>When a new request comes in, the global concurrency counter is increased. When a request is completed, the counter is decreased.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination_configuration="event-display",
destination_namespace="pingsource1",
destination_pod="event-display-00001-deployment-6b455479cb-75p6w",
destination_revision="event-display-00001"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>queue_average_proxied_concurrent_requests</code></p>
<p class="tableblock">Metric unit: dimensionless</p>
<p class="tableblock">Metric type: gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of proxied requests currently being handled by this pod:</p>
<p class="tableblock"><code>stats.AverageProxiedConcurrency</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination_configuration="event-display",
destination_namespace="pingsource1",
destination_pod="event-display-00001-deployment-6b455479cb-75p6w",
destination_revision="event-display-00001"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>process_uptime</code></p>
<p class="tableblock">Metric unit: seconds</p>
<p class="tableblock">Metric type: gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of seconds that the process has been up.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination_configuration="event-display",
destination_namespace="pingsource1",
destination_pod="event-display-00001-deployment-6b455479cb-75p6w",
destination_revision="event-display-00001"</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Metrics exposed by default for each Knative service on port 9091</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name, unit, and type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Metric tags</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>request_count</code></p>
<p class="tableblock">Metric unit: dimensionless</p>
<p class="tableblock">Metric type: counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of requests that are routed to <code>queue-proxy</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration_name="event-display",
container_name="queue-proxy",
namespace_name="apiserversource1",
pod_name="event-display-00001-deployment-658fd4f9cf-qcnr5",
response_code="200",
response_code_class="2xx",
revision_name="event-display-00001",
service_name="event-display"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>request_latencies</code></p>
<p class="tableblock">Metric unit: milliseconds</p>
<p class="tableblock">Metric type: histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response time in milliseconds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration_name="event-display",
container_name="queue-proxy",
namespace_name="apiserversource1",
pod_name="event-display-00001-deployment-658fd4f9cf-qcnr5",
response_code="200",
response_code_class="2xx",
revision_name="event-display-00001",
service_name="event-display"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app_request_count</code></p>
<p class="tableblock">Metric unit: dimensionless</p>
<p class="tableblock">Metric type: counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of requests that are routed to <code>user-container</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration_name="event-display",
container_name="queue-proxy",
namespace_name="apiserversource1",
pod_name="event-display-00001-deployment-658fd4f9cf-qcnr5",
response_code="200",
response_code_class="2xx",
revision_name="event-display-00001",
service_name="event-display"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app_request_latencies</code></p>
<p class="tableblock">Metric unit: milliseconds</p>
<p class="tableblock">Metric type: histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response time in milliseconds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration_name="event-display",
container_name="queue-proxy",
namespace_name="apiserversource1",
pod_name="event-display-00001-deployment-658fd4f9cf-qcnr5",
response_code="200",
response_code_class="2xx",
revision_name="event-display-00001",
service_name="event-display"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>queue_depth</code></p>
<p class="tableblock">Metric unit: dimensionless</p>
<p class="tableblock">Metric type: gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current number of items in the serving and waiting queue, or not reported if unlimited concurrency. <code>breaker.inFlight</code> is used.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration_name="event-display",
container_name="queue-proxy",
namespace_name="apiserversource1",
pod_name="event-display-00001-deployment-658fd4f9cf-qcnr5",
response_code="200",
response_code_class="2xx",
revision_name="event-display-00001",
service_name="event-display"</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="serverless-monitoring-services-custom-metrics">Knative service with custom application metrics</h3>
<div class="paragraph">
<p>You can extend the set of metrics exported by a Knative service. The exact implementation depends on your application and the language used.</p>
</div>
<div class="paragraph">
<p>The following listing implements a sample Go application that exports the count of processed events custom metric.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-go" data-lang="go">package main

import (
  "fmt"
  "log"
  "net/http"
  "os"

  "github.com/prometheus/client_golang/prometheus" <b class="conum">(1)</b>
  "github.com/prometheus/client_golang/prometheus/promauto"
  "github.com/prometheus/client_golang/prometheus/promhttp"
)

var (
  opsProcessed = promauto.NewCounter(prometheus.CounterOpts{ <b class="conum">(2)</b>
     Name: "myapp_processed_ops_total",
     Help: "The total number of processed events",
  })
)


func handler(w http.ResponseWriter, r *http.Request) {
  log.Print("helloworld: received a request")
  target := os.Getenv("TARGET")
  if target == "" {
     target = "World"
  }
  fmt.Fprintf(w, "Hello %s!\n", target)
  opsProcessed.Inc() <b class="conum">(3)</b>
}

func main() {
  log.Print("helloworld: starting server...")

  port := os.Getenv("PORT")
  if port == "" {
     port = "8080"
  }

  http.HandleFunc("/", handler)

  // Separate server for metrics requests
  go func() { <b class="conum">(4)</b>
     mux := http.NewServeMux()
     server := &amp;http.Server{
        Addr: fmt.Sprintf(":%s", "9095"),
        Handler: mux,
     }
     mux.Handle("/metrics", promhttp.Handler())
     log.Printf("prometheus: listening on port %s", 9095)
     log.Fatal(server.ListenAndServe())
  }()

   // Use same port as normal requests for metrics
  //http.Handle("/metrics", promhttp.Handler()) <b class="conum">(5)</b>
  log.Printf("helloworld: listening on port %s", port)
  log.Fatal(http.ListenAndServe(fmt.Sprintf(":%s", port), nil))
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Including the Prometheus packages.</p>
</li>
<li>
<p>Defining the <code>opsProcessed</code> metric.</p>
</li>
<li>
<p>Incrementing the <code>opsProcessed</code> metric.</p>
</li>
<li>
<p>Configuring to use a separate server for metrics requests.</p>
</li>
<li>
<p>Configuring to use the same port as normal requests for metrics and the <code>metrics</code> subpath.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="serverless-monitoring-services-configuration-scraping">Configuration for scraping custom metrics</h3>
<div class="paragraph">
<p>Custom metrics scraping is performed by an instance of Prometheus purposed for user workload monitoring. After you enable user workload monitoring and create the application, you need a configuration that defines how the monitoring stack will scrape the metrics.</p>
</div>
<div class="paragraph">
<p>The following sample configuration defines the <code>ksvc</code> for your application and configures the service monitor. The exact configuration depends on your application and how it exports the metrics.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: serving.knative.dev/v1 <b class="conum">(1)</b>
kind: Service
metadata:
  name: helloworld-go
spec:
  template:
    metadata:
      labels:
        app: helloworld-go
      annotations:
    spec:
      containers:
      - image: docker.io/skonto/helloworld-go:metrics
        resources:
          requests:
            cpu: "200m"
        env:
        - name: TARGET
          value: "Go Sample v1"
---
apiVersion: monitoring.coreos.com/v1 <b class="conum">(2)</b>
kind: ServiceMonitor
metadata:
  labels:
  name: helloworld-go-sm
spec:
  endpoints:
  - port: queue-proxy-metrics
    scheme: http
  - port: app-metrics
    scheme: http
  namespaceSelector: {}
  selector:
    matchLabels:
       name:  helloworld-go-sm
---
apiVersion: v1 <b class="conum">(3)</b>
kind: Service
metadata:
  labels:
    name:  helloworld-go-sm
  name:  helloworld-go-sm
spec:
  ports:
  - name: queue-proxy-metrics
    port: 9091
    protocol: TCP
    targetPort: 9091
  - name: app-metrics
    port: 9095
    protocol: TCP
    targetPort: 9095
  selector:
    serving.knative.dev/service: helloworld-go
  type: ClusterIP</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Application specification.</p>
</li>
<li>
<p>Configuration of which application&#8217;s metrics are scraped.</p>
</li>
<li>
<p>Configuration of the way metrics are scraped.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="serverless-monitoring-services-examining-metrics">Examining metrics of a service</h3>
<div class="paragraph">
<p>After you have configured the application to export the metrics and the monitoring stack to scrape them, you can examine the metrics in the web console.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in to the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed the OpenShift Serverless Operator and Knative Serving.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Optional: Run requests against your application that you will be able to see in the metrics:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ hello_route=$(oc get ksvc helloworld-go -n ns1 -o jsonpath='{.status.url}') &amp;&amp; \
    curl $hello_route</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">Hello Go Sample v1!</code></pre>
</div>
</div>
</li>
<li>
<p>In the web console, navigate to the <strong>Observe</strong> &#8594; <strong>Metrics</strong> interface.</p>
</li>
<li>
<p>In the input field, enter the query for the metric you want to observe, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>revision_app_request_count{namespace="ns1", job="helloworld-go-sm"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>myapp_processed_ops_total{namespace="ns1", job="helloworld-go-sm"}</code></pre>
</div>
</div>
</li>
<li>
<p>Observe the visualized metrics:</p>
<div class="imageblock">
<div class="content">
<img src="images/serverless-monitoring-service-example1.png" alt="Observing metrics of a service">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/serverless-monitoring-service-example2.png" alt="Observing metrics of a service">
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="serverless-queue-proxy-metrics_serverless-monitoring-services-examining-metrics">Queue proxy metrics</h4>
<div class="paragraph">
<p>Each Knative service has a proxy container that proxies the connections to the application container. A number of metrics are reported for the queue proxy performance.</p>
</div>
<div class="paragraph">
<p>You can use the following metrics to measure if requests are queued at the proxy side and the actual delay in serving requests at the application side.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Tags</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>revision_request_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of requests that are routed to <code>queue-proxy</code> pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>container_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>revision_request_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response time of revision requests.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>container_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>revision_app_request_count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of requests that are routed to the <code>user-container</code> pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>container_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>revision_app_request_latencies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response time of revision app requests.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>response_code</code>, <code>response_code_class</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>revision_queue_depth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current number of items in the <code>serving</code> and <code>waiting</code> queues. This metric is not reported if unlimited concurrency is configured.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration_name</code>, <code>event-display</code>, <code>container_name</code>, <code>namespace_name</code>, <code>pod_name</code>, <code>response_code_class</code>, <code>revision_name</code>, <code>service_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer (no units)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="serverless-developer-metrics-dashboard">Dashboard for service metrics</h3>
<div class="paragraph">
<p>You can examine the metrics using a dedicated dashboard that aggregates queue proxy metrics by namespace.</p>
</div>
<div class="sect3">
<h4 id="serverless-monitoring-services-examining-metrics-dashboard_serverless-developer-metrics-dashboard">Examining metrics of a service in the dashboard</h4>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in to the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed the OpenShift Serverless Operator and Knative Serving.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the web console, navigate to the <strong>Observe</strong> &#8594; <strong>Metrics</strong> interface.</p>
</li>
<li>
<p>Select the <code>Knative User Services (Queue Proxy metrics)</code> dashboard.</p>
</li>
<li>
<p>Select the <strong>Namespace</strong>, <strong>Configuration</strong>, and <strong>Revision</strong> that correspond to your application.</p>
</li>
<li>
<p>Observe the visualized metrics:</p>
<div class="imageblock">
<div class="content">
<img src="images/serverless-monitoring-service-example-dashboard.png" alt="Observing metrics of a service using a dashboard">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cluster-logging">Cluster logging</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cluster-logging-serverless">Using OpenShift Logging with OpenShift Serverless</h3>
<div class="sect3">
<h4 id="cluster-logging-about_cluster-logging-serverless">About deploying the logging subsystem for Red Hat OpenShift</h4>
<div class="paragraph">
<p>OpenShift Container Platform cluster administrators can deploy the logging subsystem using the OpenShift Container Platform web console or CLI to install the OpenShift Elasticsearch Operator and Red Hat OpenShift Logging Operator. When the Operators are installed, you create a <code>ClusterLogging</code> custom resource (CR) to schedule logging subsystem pods and other resources necessary to support the logging subsystem. The Operators are responsible for deploying, upgrading, and maintaining the logging subsystem.</p>
</div>
<div class="paragraph">
<p>The <code>ClusterLogging</code> CR defines a complete logging subsystem environment that includes all the components of the logging stack to collect, store and visualize logs. The Red Hat OpenShift Logging Operator watches the logging subsystem CR and adjusts the logging deployment accordingly.</p>
</div>
<div class="paragraph">
<p>Administrators and application developers can view the logs of the projects for which they have view access.</p>
</div>
</div>
<div class="sect3">
<h4 id="cluster-logging-deploying-about_cluster-logging-serverless">About deploying and configuring the logging subsystem for Red Hat OpenShift</h4>
<div class="paragraph">
<p>The logging subsystem is designed to be used with the default configuration, which is tuned for small to medium sized OpenShift Container Platform clusters.</p>
</div>
<div class="paragraph">
<p>The installation instructions that follow include a sample <code>ClusterLogging</code> custom resource (CR), which you can use to create a logging subsystem instance and configure your logging subsystem environment.</p>
</div>
<div class="paragraph">
<p>If you want to use the default logging subsystem install, you can use the sample CR directly.</p>
</div>
<div class="paragraph">
<p>If you want to customize your deployment, make changes to the sample CR as needed. The following describes the configurations you can make when installing your OpenShift Logging instance or modify after installation. See the Configuring sections for more information on working with each component, including modifications you can make outside of the <code>ClusterLogging</code> custom resource.</p>
</div>
<div class="sect4">
<h5 id="cluster-logging-deploy-about-config_cluster-logging-serverless">Configuring and Tuning the logging subsystem</h5>
<div class="paragraph">
<p>You can configure your logging subsystem by modifying the <code>ClusterLogging</code> custom resource deployed
in the <code>openshift-logging</code> project.</p>
</div>
<div class="paragraph">
<p>You can modify any of the following components upon install or after install:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Memory and CPU</dt>
<dd>
<p>You can adjust both the CPU and memory limits for each component by modifying the <code>resources</code>
block with valid memory and CPU values:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">spec:
  logStore:
    elasticsearch:
      resources:
        limits:
          cpu:
          memory: 16Gi
        requests:
          cpu: 500m
          memory: 16Gi
      type: "elasticsearch"
  collection:
    logs:
      fluentd:
        resources:
          limits:
            cpu:
            memory:
          requests:
            cpu:
            memory:
        type: "fluentd"
  visualization:
    kibana:
      resources:
        limits:
          cpu:
          memory:
        requests:
          cpu:
          memory:
      type: kibana</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Elasticsearch storage</dt>
<dd>
<p>You can configure a persistent storage class and size for the Elasticsearch cluster using the <code>storageClass</code> <code>name</code> and <code>size</code> parameters. The Red Hat OpenShift Logging Operator creates a persistent volume claim (PVC) for each data node in the Elasticsearch cluster based on these parameters.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">  spec:
    logStore:
      type: "elasticsearch"
      elasticsearch:
        nodeCount: 3
        storage:
          storageClassName: "gp2"
          size: "200G"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example specifies each data node in the cluster will be bound to a PVC that
requests "200G" of "gp2" storage. Each primary shard will be backed by a single replica.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Omitting the <code>storage</code> block results in a deployment that includes ephemeral storage only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">  spec:
    logStore:
      type: "elasticsearch"
      elasticsearch:
        nodeCount: 3
        storage: {}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Elasticsearch replication policy</dt>
<dd>
<p>You can set the policy that defines how Elasticsearch shards are replicated across data nodes in the cluster:</p>
<div class="ulist">
<ul>
<li>
<p><code>FullRedundancy</code>. The shards for each index are fully replicated to every data node.</p>
</li>
<li>
<p><code>MultipleRedundancy</code>. The shards for each index are spread over half of the data nodes.</p>
</li>
<li>
<p><code>SingleRedundancy</code>. A single copy of each shard. Logs are always available and recoverable as long as at least two data nodes exist.</p>
</li>
<li>
<p><code>ZeroRedundancy</code>. No copies of any shards. Logs may be unavailable (or lost) in the event a node is down or fails.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="cluster-logging-deploy-about-sample_cluster-logging-serverless">Sample modified ClusterLogging custom resource</h5>
<div class="paragraph">
<p>The following is an example of a <code>ClusterLogging</code> custom resource modified using the options previously described.</p>
</div>
<div class="listingblock">
<div class="title">Sample modified <code>ClusterLogging</code> custom resource</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: "logging.openshift.io/v1"
kind: "ClusterLogging"
metadata:
  name: "instance"
  namespace: "openshift-logging"
spec:
  managementState: "Managed"
  logStore:
    type: "elasticsearch"
    retentionPolicy:
      application:
        maxAge: 1d
      infra:
        maxAge: 7d
      audit:
        maxAge: 7d
    elasticsearch:
      nodeCount: 3
      resources:
        limits:
          cpu: 200m
          memory: 16Gi
        requests:
          cpu: 200m
          memory: 16Gi
        storage:
          storageClassName: "gp2"
          size: "200G"
      redundancyPolicy: "SingleRedundancy"
  visualization:
    type: "kibana"
    kibana:
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 500m
          memory: 1Gi
      replicas: 1
  collection:
    logs:
      type: "fluentd"
      fluentd:
        resources:
          limits:
            memory: 1Gi
          requests:
            cpu: 200m
            memory: 1Gi</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="finding-serving-logs-components">Finding logs for Knative Serving components</h3>
<div class="paragraph">
<p>You can find the logs for Knative Serving components using the following procedure.</p>
</div>
<div class="sect3">
<h4 id="using-cluster-logging-to-find-logs-for-knative-serving-components_finding-serving-logs-components">Using OpenShift Logging to find logs for Knative Serving components</h4>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Install the OpenShift CLI (<code>oc</code>).</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Get the Kibana route:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ oc -n openshift-logging get route kibana</code></pre>
</div>
</div>
</li>
<li>
<p>Use the route&#8217;s URL to navigate to the Kibana dashboard and log in.</p>
</li>
<li>
<p>Check that the index is set to <strong>.all</strong>. If the index is not set to <strong>.all</strong>, only the OpenShift Container Platform system logs will be listed.</p>
</li>
<li>
<p>Filter the logs by using the <code>knative-serving</code> namespace. Enter <code>kubernetes.namespace_name:knative-serving</code> in the search box to filter results.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Knative Serving uses structured logging by default. You can enable the parsing of these logs by customizing the OpenShift Logging Fluentd settings. This makes the logs more searchable and enables filtering on the log level to quickly identify issues.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="finding-serving-logs-services">Finding logs for Knative Serving services</h3>
<div class="paragraph">
<p>You can find the logs for Knative Serving services using the following procedure.</p>
</div>
<div class="sect3">
<h4 id="using-cluster-logging-to-find-logs-for-services-deployed-with-knative-serving_finding-serving-logs-services">Using OpenShift Logging to find logs for services deployed with Knative Serving</h4>
<div class="paragraph">
<p>With OpenShift Logging, the logs that your applications write to the console are collected in Elasticsearch. The following procedure outlines how to apply these capabilities to applications deployed by using Knative Serving.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Install the OpenShift CLI (<code>oc</code>).</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Get the Kibana route:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ oc -n openshift-logging get route kibana</code></pre>
</div>
</div>
</li>
<li>
<p>Use the route&#8217;s URL to navigate to the Kibana dashboard and log in.</p>
</li>
<li>
<p>Check that the index is set to <strong>.all</strong>. If the index is not set to <strong>.all</strong>, only the OpenShift system logs will be listed.</p>
</li>
<li>
<p>Filter the logs by using the <code>knative-serving</code> namespace. Enter a filter for the service in the search box to filter results.</p>
<div class="listingblock">
<div class="title">Example filter</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">kubernetes.namespace_name:default AND kubernetes.labels.serving_knative_dev\/service:{service_name}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also filter by using <code>/configuration</code> or <code>/revision</code>.</p>
</div>
</li>
<li>
<p>Narrow your search by using <code>kubernetes.container_name:&lt;user_container&gt;</code> to only display the logs generated by your application. Otherwise, you will see logs from the queue-proxy.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Use JSON-based structured logging in your application to allow for the quick filtering of these logs in production environments.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tracing">Tracing</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="serverless-tracing">Tracing requests</h3>
<div class="paragraph">
<p>Distributed tracing records the path of a request through the various services that make up an application. It is used to tie information about different units of work together, to understand a whole chain of events in a distributed transaction. The units of work might be executed in different processes or hosts.</p>
</div>
<div class="sect3">
<h4 id="distr-tracing-product-overview_serverless-tracing">Distributed tracing overview</h4>
<div class="paragraph">
<p>As a service owner, you can use distributed tracing to instrument your services to gather insights into your service architecture.
You can use distributed tracing for monitoring, network profiling, and troubleshooting the interaction between components in modern, cloud-native, microservices-based applications.</p>
</div>
<div class="paragraph">
<p>With distributed tracing you can perform the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Monitor distributed transactions</p>
</li>
<li>
<p>Optimize performance and latency</p>
</li>
<li>
<p>Perform root cause analysis</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Red Hat OpenShift distributed tracing consists of two main components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Red Hat OpenShift distributed tracing platform</strong> - This component is based on the open source <a href="https://www.jaegertracing.io/">Jaeger project</a>.</p>
</li>
<li>
<p><strong>Red Hat OpenShift distributed tracing data collection</strong> - This component is based on the open source <a href="https://opentelemetry.io/">OpenTelemetry project</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both of these components are based on the vendor-neutral <a href="https://opentracing.io/">OpenTracing</a> APIs and instrumentation.</p>
</div>
</div>
<div class="sect3 _additional-resources">
<h4 id="additional-resources_serverless-tracing">Additional resources for OpenShift Container Platform</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.openshift.com/container-platform/latest/distr_tracing/distr_tracing_arch/distr-tracing-architecture.html#distr-tracing-architecture">Red Hat OpenShift distributed tracing architecture</a></p>
</li>
<li>
<p><a href="https://docs.openshift.com/container-platform/latest/distr_tracing/distr_tracing_install/distr-tracing-installing.html#installing-distributed-tracing">Installing distributed tracing</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="serverless-tracing-open-telemetry">Using Red Hat OpenShift distributed tracing</h3>
<div class="paragraph">
<p>You can use Red Hat OpenShift distributed tracing with OpenShift Serverless to monitor and troubleshoot serverless applications.</p>
</div>
<div class="sect3">
<h4 id="serverless-open-telemetry_serverless-tracing-open-telemetry">Using Red Hat OpenShift distributed tracing to enable distributed tracing</h4>
<div class="paragraph">
<p>Red Hat OpenShift distributed tracing is made up of several components that work together to collect, store, and display tracing data.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have access to an OpenShift Container Platform account with cluster administrator access.</p>
</li>
<li>
<p>You have not yet installed the OpenShift Serverless Operator, Knative Serving, and Knative Eventing. These must be installed after the Red Hat OpenShift distributed tracing installation.</p>
</li>
<li>
<p>You have installed Red Hat OpenShift distributed tracing by following the OpenShift Container Platform "Installing distributed tracing" documentation.</p>
</li>
<li>
<p>You have installed the OpenShift CLI (<code>oc</code>).</p>
</li>
<li>
<p>You have created a project or have access to a project with the appropriate roles and permissions to create applications and other workloads in OpenShift Container Platform.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create an <code>OpenTelemetryCollector</code> custom resource (CR):</p>
<div class="listingblock">
<div class="title">Example OpenTelemetryCollector CR</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: opentelemetry.io/v1alpha1
kind: OpenTelemetryCollector
metadata:
  name: cluster-collector
  namespace: &lt;namespace&gt;
spec:
  mode: deployment
  config: |
    receivers:
      zipkin:
    processors:
    exporters:
      jaeger:
        endpoint: jaeger-all-in-one-inmemory-collector-headless.tracing-system.svc:14250
        tls:
          ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/service-ca.crt"
      logging:
    service:
      pipelines:
        traces:
          receivers: [zipkin]
          processors: []
          exporters: [jaeger, logging]</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that you have two pods running in the namespace where Red Hat OpenShift distributed tracing is installed:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ oc get pods -n &lt;namespace&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">NAME                                          READY   STATUS    RESTARTS   AGE
cluster-collector-collector-85c766b5c-b5g99   1/1     Running   0          5m56s
jaeger-all-in-one-inmemory-ccbc9df4b-ndkl5    2/2     Running   0          15m</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the following headless services have been created:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ oc get svc -n &lt;namespace&gt; | grep headless</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">cluster-collector-collector-headless            ClusterIP   None             &lt;none&gt;        9411/TCP                                 7m28s
jaeger-all-in-one-inmemory-collector-headless   ClusterIP   None             &lt;none&gt;        9411/TCP,14250/TCP,14267/TCP,14268/TCP   16m</code></pre>
</div>
</div>
<div class="paragraph">
<p>These services are used to configure Jaeger, Knative Serving, and Knative Eventing. The name of the Jaeger service may vary.</p>
</div>
</li>
<li>
<p>Install the OpenShift Serverless Operator by following the "Installing the OpenShift Serverless Operator" documentation.</p>
</li>
<li>
<p>Install Knative Serving by creating the following <code>KnativeServing</code> CR:</p>
<div class="listingblock">
<div class="title">Example KnativeServing CR</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: operator.knative.dev/v1beta1
kind: KnativeServing
metadata:
    name: knative-serving
    namespace: knative-serving
spec:
  config:
    tracing:
      backend: "zipkin"
      zipkin-endpoint: "http://cluster-collector-collector-headless.tracing-system.svc:9411/api/v2/spans"
      debug: "false"
      sample-rate: "0.1" <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>sample-rate</code> defines sampling probability. Using <code>sample-rate: "0.1"</code> means that 1 in 10 traces are sampled.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Install Knative Eventing by creating the following <code>KnativeEventing</code> CR:</p>
<div class="listingblock">
<div class="title">Example KnativeEventing CR</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: operator.knative.dev/v1beta1
kind: KnativeEventing
metadata:
    name: knative-eventing
    namespace: knative-eventing
spec:
  config:
    tracing:
      backend: "zipkin"
      zipkin-endpoint: "http://cluster-collector-collector-headless.tracing-system.svc:9411/api/v2/spans"
      debug: "false"
      sample-rate: "0.1" <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>sample-rate</code> defines sampling probability. Using <code>sample-rate: "0.1"</code> means that 1 in 10 traces are sampled.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a Knative service:</p>
<div class="listingblock">
<div class="title">Example service</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: helloworld-go
spec:
  template:
    metadata:
      labels:
        app: helloworld-go
      annotations:
        autoscaling.knative.dev/minScale: "1"
        autoscaling.knative.dev/target: "1"
    spec:
      containers:
      - image: quay.io/openshift-knative/helloworld:v1.2
        imagePullPolicy: Always
        resources:
          requests:
            cpu: "200m"
        env:
        - name: TARGET
          value: "Go Sample v1"</code></pre>
</div>
</div>
</li>
<li>
<p>Make some requests to the service:</p>
<div class="listingblock">
<div class="title">Example HTTPS request</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ curl https://helloworld-go.example.com</code></pre>
</div>
</div>
</li>
<li>
<p>Get the URL for the Jaeger web console:</p>
<div class="listingblock">
<div class="title">Example command</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ oc get route jaeger-all-in-one-inmemory  -o jsonpath='{.spec.host}' -n &lt;namespace&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now examine traces by using the Jaeger console.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="serverless-tracing-jaeger">Using Jaeger distributed tracing</h3>
<div class="paragraph">
<p>If you do not want to install all of the components of Red Hat OpenShift distributed tracing, you can still use distributed tracing on OpenShift Container Platform with OpenShift Serverless.</p>
</div>
<div class="sect3">
<h4 id="serverless-jaeger-config_serverless-tracing-jaeger">Configuring Jaeger to enable distributed tracing</h4>
<div class="paragraph">
<p>To enable distributed tracing using Jaeger, you must install and configure Jaeger as a standalone integration.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cluster administrator permissions on OpenShift Container Platform, or you have cluster or dedicated administrator permissions on Red Hat OpenShift Service on AWS or OpenShift Dedicated.</p>
</li>
<li>
<p>You have installed the OpenShift Serverless Operator, Knative Serving, and Knative Eventing.</p>
</li>
<li>
<p>You have installed the Red Hat OpenShift distributed tracing platform Operator.</p>
</li>
<li>
<p>You have installed the OpenShift CLI (<code>oc</code>).</p>
</li>
<li>
<p>You have created a project or have access to a project with the appropriate roles and permissions to create applications and other workloads.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create and apply a <code>Jaeger</code> custom resource (CR) that contains the following:</p>
<div class="listingblock">
<div class="title">Jaeger CR</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: jaegertracing.io/v1
kind: Jaeger
metadata:
  name: jaeger
  namespace: default</code></pre>
</div>
</div>
</li>
<li>
<p>Enable tracing for Knative Serving, by editing the <code>KnativeServing</code> CR and adding a YAML configuration for tracing:</p>
<div class="listingblock">
<div class="title">Tracing YAML example for Serving</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: operator.knative.dev/v1beta1
kind: KnativeServing
metadata:
  name: knative-serving
  namespace: knative-serving
spec:
  config:
    tracing:
      sample-rate: "0.1" <b class="conum">(1)</b>
      backend: zipkin <b class="conum">(2)</b>
      zipkin-endpoint: "http://jaeger-collector.default.svc.cluster.local:9411/api/v2/spans" <b class="conum">(3)</b>
      debug: "false" <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>sample-rate</code> defines sampling probability. Using <code>sample-rate: "0.1"</code> means that 1 in 10 traces are sampled.</p>
</li>
<li>
<p><code>backend</code> must be set to <code>zipkin</code>.</p>
</li>
<li>
<p>The <code>zipkin-endpoint</code> must point to your <code>jaeger-collector</code> service endpoint. To get this endpoint, substitute the namespace where the Jaeger CR is applied.</p>
</li>
<li>
<p>Debugging should be set to <code>false</code>. Enabling debug mode by setting <code>debug: "true"</code> allows all spans to be sent to the server, bypassing sampling.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Enable tracing for Knative Eventing by editing the <code>KnativeEventing</code> CR:</p>
<div class="listingblock">
<div class="title">Tracing YAML example for Eventing</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-yaml" data-lang="yaml">apiVersion: operator.knative.dev/v1beta1
kind: KnativeEventing
metadata:
  name: knative-eventing
  namespace: knative-eventing
spec:
  config:
    tracing:
      sample-rate: "0.1" <b class="conum">(1)</b>
      backend: zipkin <b class="conum">(2)</b>
      zipkin-endpoint: "http://jaeger-collector.default.svc.cluster.local:9411/api/v2/spans" <b class="conum">(3)</b>
      debug: "false" <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>sample-rate</code> defines sampling probability. Using <code>sample-rate: "0.1"</code> means that 1 in 10 traces are sampled.</p>
</li>
<li>
<p>Set <code>backend</code> to <code>zipkin</code>.</p>
</li>
<li>
<p>Point the <code>zipkin-endpoint</code> to your <code>jaeger-collector</code> service endpoint. To get this endpoint, substitute the namespace where the Jaeger CR is applied.</p>
</li>
<li>
<p>Debugging should be set to <code>false</code>. Enabling debug mode by setting <code>debug: "true"</code> allows all spans to be sent to the server, bypassing sampling.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Verification</div>
<p>You can access the Jaeger web console to see tracing data, by using the <code>jaeger</code> route.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the <code>jaeger</code> route&#8217;s hostname by entering the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">$ oc get route jaeger -n default</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="highlight nowrap"><code class="language-terminal" data-lang="terminal">NAME     HOST/PORT                         PATH   SERVICES       PORT    TERMINATION   WILDCARD
jaeger   jaeger-default.apps.example.com          jaeger-query   &lt;all&gt;   reencrypt     None</code></pre>
</div>
</div>
</li>
<li>
<p>Open the endpoint address in your browser to view the console.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-06-21 10:15:23 UTC
</div>
</div>
</body>
</html>